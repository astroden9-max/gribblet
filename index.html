<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Revive Ad Test</title>
<style>
  html, body {
    margin: 0; padding: 0; width: 100%; height: 100%;
    background: #000; display: flex; justify-content: center; align-items: center;
  }
  #ad-container {
    width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;
    background-color: #111; margin: 0; padding: 0;
  }
  #ad-container iframe, #ad-container img {
    width: 100%; height: 100%; object-fit: cover; display: block;
  }
</style>
</head>
<body>
<div id="ad-container">
  <script type='text/javascript'>
    var m3_u = (location.protocol=='https:'?'https://assets.gribblet-dev.shop/resources/www/delivery/ajs.php':'http://assets.gribblet-dev.shop/resources/www/delivery/ajs.php');
    var m3_r = Math.floor(Math.random()*99999999999);
    if (!document.MAX_used) document.MAX_used = ',';
    document.write("<scr"+"ipt type='text/javascript' src='"+m3_u);
    document.write("?zoneid=1");
    document.write('&cb=' + m3_r);
    if (document.MAX_used != ',') document.write("&exclude=" + document.MAX_used);
    document.write(document.charset ? '&charset='+document.charset : (document.characterSet ? '&charset='+document.characterSet : ''));
    document.write("&loc=" + encodeURIComponent(window.location));
    document.write("'><\/scr"+"ipt>");
  </script>
</div>

<script>
  // Listen for messages from the iframe/ad content
  window.addEventListener('message', (event) => {
    // Ensure the message comes from the Revive domain
    if (event.origin !== "https://assets.gribblet-dev.shop") return;

    const data = event.data;
    if (data === 'ad-clicked') {
      console.log("Ad clicked, navigating in same tab...");
      // Use Brave's navigation API (if inside NTP)
      try {
        window.parent.postMessage({ type: 'navigate', url: 'https://timesofindia.indiatimes.com/' }, '*');
      } catch (e) {
        // Fallback for testing in browser
        window.location.href = 'https://timesofindia.indiatimes.com/';
      }
    }
    if (data === 'ad-loaded-success') {
      console.log("Ad loaded successfully.");
      // Stop fallback timer in parent if needed
    }
  });
</script>
</body>
</html>
